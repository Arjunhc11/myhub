<!Doctype html>
<html>

<head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ"
    crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="style.css">
  <title>SDK Test</title>
</head>

<body>
  <div class="container">
    <div style="text-align:center;">
      <div id="menu"></div>
      <div id="menuLegacy"></div>
      <h2 class="form-signin-heading">
        SDK Test
      </h2>
    </div>
    <form class="form-signin" >
      <input type="hidden" id="confirmation" name="receiptId" value="" />
      <input type="text" id="name" class="form-control" placeholder="Your name">
      <input type="email" id="inputEmail" class="form-control" placeholder="Email address" required>
	  <div id="purposes">
	  
	  </div>
      <button id="trigger" class="btn btn-lg btn-primary btn-block" type="submit">
        Submit form
      </button>
    </form>
    <div id="sdkSettings">
      <h4 style="text-align: center">SDK JS Settings:</h4>
        
    </div>
  </div>

<!-- OneTrust Consent Receipt Start -->
<script
  src="https://stagingdsadc3.blob.core.windows.net/consent-receipt-scripts/scripts/otconsent-1.0.min.js"
  type="text/javascript"
  charset="UTF-8"
  id="consent-receipt-script">
  triggerId="trigger";
  identifierId="inputEmail";
  confirmationId="confirmation";
  token="eyJhbGciOiJSUzUxMiJ9.eyJvdEp3dFZlcnNpb24iOjEsInByb2Nlc3NJZCI6ImUzMzU2MWUzLWEyNzYtNGNkZS1hMGY2LWUyZjk3MjJhMDRhYSIsInByb2Nlc3NWZXJzaW9uIjoxLCJpYXQiOiIyMDIwLTA2LTAzVDE0OjUwOjIzLjE3NyIsIm1vYyI6IldFQl9GT1JNIiwic3ViIjoiRW1haWwiLCJpc3MiOm51bGwsInRlbmFudElkIjoiMWNjYWFmNGYtZWNhMy00YWM0LThjNzYtNDQ3NjczMDlmYzM3IiwiZGVzY3JpcHRpb24iOiJkZXNjIiwiY29uc2VudFR5cGUiOiJDT05ESVRJT05BTFRSSUdHRVIiLCJkb3VibGVPcHRJbiI6ZmFsc2UsInBvbGljeV91cmkiOm51bGwsImFsbG93Tm90R2l2ZW5Db25zZW50cyI6dHJ1ZSwicHVycG9zZXMiOlt7ImlkIjoiNTNmYTZmZWYtOGE1NC00N2U2LWI0NjQtYmY5YjRlZmVlZThiIiwidmVyc2lvbiI6MSwidG9waWNzIjpbXSwiY3VzdG9tUHJlZmVyZW5jZXMiOltdfSx7ImlkIjoiMTdjYWJiNWItYmVhNy00MDlhLWEzY2YtMGU0NjBlYjE5NzQxIiwidmVyc2lvbiI6NCwidG9waWNzIjpbXSwiY3VzdG9tUHJlZmVyZW5jZXMiOltdfSx7ImlkIjoiMTY1NWQxZDgtMjMwZS00NjY1LTg1YTItMDY1ZjJkYzk0YmIxIiwidmVyc2lvbiI6MiwidG9waWNzIjpbXSwiY3VzdG9tUHJlZmVyZW5jZXMiOltdfV0sIm5vdGljZXMiOltdLCJkc0RhdGFFbGVtZW50cyI6W119.cOmxUNximxF8thGaRc3n8CY-rmuMoVD1GUAsyK9x0tDTHUcgFYLc2cW-zzFspxkIAgPgWcEMgzCxLu9btOu1Q4Lxz8uPecVGP4QM5_DIKEeDbqIb1rde1vZOkEnTRLZ911BgOAv1IDO_-35cxH5ZCexFpD8Eud86FRicuiM57aPNqkSKsCTjBcUzW6ZoDZYMvDhxEgOolL3-aqXJXqjL8f51RlVzxw_RSruUuoRFBIF0ZB-fRmE7OdEcG74uDpY9ELbF-m8GAj9RcU3moZ1J-RcNQc07srZIgjdD0WzHap-DeTxXEoqk-ClECn_d1nUsnBy7DS_TcALpAp9AUhoHsdukUPgwYQUrm0iZ5hv7jsu-05EE-gJ99ezXfUgh-vZeJS3ZZ3DGE7xotg6L4akM7CEo9KaOliazSYdtJk4eZLhxA3np9zXElOtJth_BiCxFmG23jyXhdg3uy7KbTV8lXZxvNMsTQMPABHx9M9kRfhRO4URRTZg5IxCrtTWm3v3noFLvWXqsT2l8T24mqL33lQ-bdxDEKiAxuTN1m-VJ5b7rhlcwzy0qb34nZT5EcESzyohFQAoFpRV_q3WOa2odW1cTf4jl1aoBfhi2froDpBARdk3P9q0u0TXEKD3Q52qM4NLOU3PU1K7nsXnHOjDhKdzEYWHC6I7OlmLDVeGVJzw";
  settings="eyJyZWNlaXB0QXBpRW5kcG9pbnQiOiJodHRwczovL3ByaXZhY3lwb3J0YWwtc3RhZ2luZy4xdHJ1c3QubmluamEvcmVxdWVzdC92MS9jb25zZW50cmVjZWlwdHMiLCJtYW51YWxUcmlnZ2VyIjpmYWxzZSwiY29udGludWVPbkVycm9yIjp0cnVlfQ==";
</script>
<script type="text/javascript" charset="UTF-8">
  OneTrust.ScriptTag.Preferences = [  
  {
    "purpose": "53fa6fef-8a54-47e6-b464-bf9b4efeee8b",
    "identifierAttributes": "value",
    "identifierValues": "Atest",
  },  
  {
    "purpose": "17cabb5b-bea7-409a-a3cf-0e460eb19741",
    "identifierAttributes": "value",
    "identifierValues": "Custom Category 011",
  },  
  {
    "purpose": "1655d1d8-230e-4665-85a2-065f2dc94bb1",
    "identifierAttributes": "value",
    "identifierValues": "Custom Category 02",
  }
  ];
</script>
<!-- OneTrust Consent Receipt End -->
<script type="text/javascript" charset="UTF-8">
var language = "en-us";
var purposes = OneTrust.ScriptTag.Preferences;
//console.log(purposes);
	  
var purposesList = document.createDocumentFragment();
purposes.forEach(function (pItem) {
		var purposeName = pItem.identifierValues;
		if (language != null && language != "" && language != 0) {
		var pLabel = OneTrust.Api.GetPurposeLabel(pItem.purpose, language);
			if (pLabel != null) {
				purposeName = pLabel.label;
			}
		}
			
			var purpose = document.createElement('div');
			purpose.class = "checkbox";
			var label = getLabel(pItem, purposeName);
			purpose.appendChild(label);
		   
		   var topics = pItem.topics;
		   if (topics != undefined || topics != null) {
				topics.forEach(function (tItem) {
					var topicList = document.createElement('ul');
					topicList.appendChild(getTopic(tItem, language));
					purpose.appendChild(topicList);
				});
		   }

			 var customPreferences = pItem.customPreferences;
		   if (customPreferences != undefined || customPreferences != null) {
				customPreferences.forEach(function (customPreference) {
					customPreference.options.forEach((option) => {
						var optionsList = document.createElement('ul');
						optionsList.appendChild(getCustomPreferencesOptions(option, language));
						purpose.appendChild(optionsList);
					});
				});
		   }

		   purposesList.appendChild(purpose);
});

document.getElementById('purposes').appendChild(purposesList);
document.getElementById('sdkSettings').appendChild(getSDKSettings());

function getCustomPreferencesOptions(optionItem, language) {
		var optionName = optionItem.identifierValues;		
		var optionItemLi = document.createElement('li');
		var label = getLabel(optionItem, optionName);
		optionItemLi.appendChild(label);
		
		return optionItemLi;
}

function getTopic(tItem, language) {
		var topicName = tItem.identifierValues;
		if (language != null && language != "" && language != 0) {
		var tLabel = OneTrust.Api.GetTopicLabel(tItem.topic, language);
			if (tLabel != null) {
				topicName = tLabel.label;
			}
		}
		
		var topic = document.createElement('li');
//		topic.class = "checkbox";
		var label = getLabel(tItem, topicName);
		topic.appendChild(label);
		
		return topic;
		   
}

function getLabel(item, text) {

	var label = document.createElement('label');
	var input = document.createElement('input');
	
		input.value = item.identifierValues;
		input.type = "checkbox";
	label.appendChild(input);
	var textNode = document.createTextNode(text);
	label.appendChild(textNode);
	return label;
}

function getSDKSettings() {
	var booleanValue = OneTrust.ScriptTag.NoConsentTransactions;
	var pre = document.createElement("pre");
	var code = document.createElement("code");
	var textNode = document.createTextNode("OneTrust.ScriptTag.NoConsentTransactions = " + booleanValue + "; \n");
	code.appendChild(textNode);
	pre.appendChild(code);
	return pre;
}
</script>
</body>

</html>
